<!DOCTYPE html>
<html>
<head>
    <title><%= title %></title>
    <link href="/stylesheets/c3.css" rel="stylesheet" type="text/css">
    <script src="/javascripts/d3.min.js" charset="utf-8"></script>
    <script src="/javascripts/c3.min.js"></script>
    <script>
        $('#search_button').tooltip(options)
    </script>
    <style>
        .table-header-rotated th.row-header{
            width: auto;
        }

        .table-header-rotated td{
            width: 40px;
            border-top: 1px solid #dddddd;
            border-left: 1px solid #dddddd;
            border-right: 1px solid #dddddd;
            vertical-align: middle;
            text-align: center;
        }

        .table-header-rotated th.rotate-45{
            height: 80px;
            /*width: 40px;*/
            min-width: 40px;
            max-width: 40px;
            position: relative;
            vertical-align: bottom;
            padding: 0;
            font-size: 12px;
            line-height: 0.8;
        }

        .table-header-rotated th.rotate-45 > div{
            position: relative;
            top: 0px;
            left: 40px; /* 80 * tan(45) / 2 = 40 where 80 is the height on the cell and 45 is the transform angle*/
            height: 100%;
            -ms-transform:skew(-45deg,0deg);
            -moz-transform:skew(-45deg,0deg);
            -webkit-transform:skew(-45deg,0deg);
            -o-transform:skew(-45deg,0deg);
            transform:skew(-45deg,0deg);
            overflow: hidden;
            border-left: 1px solid #dddddd;
            border-right: 1px solid #dddddd;
            border-top: 1px solid #dddddd;
        }

        .table-header-rotated th.rotate-45 span {
            -ms-transform:skew(45deg,0deg) rotate(315deg);
            -moz-transform:skew(45deg,0deg) rotate(315deg);
            -webkit-transform:skew(45deg,0deg) rotate(315deg);
            -o-transform:skew(45deg,0deg) rotate(315deg);
            transform:skew(45deg,0deg) rotate(315deg);
            position: absolute;
            bottom: 30px; /* 40 cos(45) = 28 with an additional 2px margin*/
            left: -25px; /*Because it looked good, but there is probably a mathematical link here as well*/
            display: inline-block;
        // width: 100%;
            width: 85px; /* 80 / cos(45) - 40 cos (45) = 85 where 80 is the height of the cell, 40 the width of the cell and 45 the transform angle*/
            text-align: left;
        // white-space: nowrap; /*whether to display in one line or not*/
        }

        .letterP4 {
            -webkit-transform: rotate(-90deg);
            -moz-transform: rotate(-90deg);
            -ms-transform: rotate(-90deg);
            -o-transform: rotate(-90deg);
            transform: rotate(-90deg);
            /*color: #000;*/
            /*font-size: 22px;*/
            /*height: 200px;*/
            /*width: 200px;*/
            /*float: left;*/
            /*vertical-align:top;*/
        }
    </style>
</head>
<body>

<div class="accordion-group">
    <div class="accordion-heading">
        <div class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
            <legend>查詢 CDR <i class="icon-chevron-down"></i></legend>
        </div>
    </div>
    <div id="collapseTwo" class="accordion-body collapse">
        <div class="accordion-inner">

<form class="form-horizontal" method="post">
    <fieldset>
        <!--<legend>查詢 CDR</legend>-->

        <table class="table table-hover table-condensed borderless">
            <caption></caption>
            <thead>
            <tr>
            <tr>
                <th id="name0">名稱</th>
                <th id="field0">field</th>
                <th id="input0">input</th>
                <th id="sample0">sample</th>
            </tr>
            </thead>

            <tbody>
            <script>
                var today = new Date().toISOString().split('T')[0];
                var T0 = new Date(new Date()-6*24*60*60*1000).toISOString().split('T')[0];
                document.getElementsByName("date_time")[0].setAttribute('min', T0);
                document.getElementsByName("date_time")[0].setAttribute('max', today);
            </script>
            <tr>
                <td id="name17">日期時間</td>
                <td id="field17"><label for="date_time">date_time</label></td>
                <td id="input17"><input type="text"  class="input-large" id="date_time" name="date_time"/></td>
                <td id="sample17">2014-12-21</td><!--type="date"-->
            </tr>

            <!--<tr>-->
                <!--<td id="name13">通話開始時間</td>-->
                <!--<td id="field13"><label for="charging_start_time">charging_start_time</label></td>-->
                <!--<td id="input13"><input type="text"  class="input-large" id="charging_start_time"-->
                                        <!--name="charging_start_time"/></td>-->
                <!--<td id="sample13">2014-12-21 24:59:59</td>&lt;!&ndash;type="datetime-local"&ndash;&gt;-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td id="name12">通話結束時間</td>-->
                <!--<td id="field12"><label for="charging_end_time">charging_end_time</label></td>-->
                <!--<td id="input12"><input type="type"  class="input-large" id="charging_end_time" name="charging_end_time"/></td>-->
                <!--<td id="sample12">2014-12-21 01:01:01</td>&lt;!&ndash;type="datetime-local"&ndash;&gt;-->
            <!--</tr>-->

            <tr>
                <td id="name2">被叫號碼</td>
                <td id="field2"><label for=>called_number</label></td>
                <td id="input2"><input type="text" class="input-large" id="called_number" name="called_number"/></td>
                <td id="sample2">926743611</td>
            </tr>
            <!--<tr>-->
                <!--<td id="name3">IMEI</td>-->
                <!--<td id="field3"><label for="imei">imei</label></td>-->
                <!--<td id="input3">-->
                    <!--<input type="text" class="input-medium" id="calling_imei" name="calling_imei" placeholder="calling_imei"/>-->
                    <!--<input type="text" class="input-medium" id="called_imei"  name="called_imei"  placeholder="called_imei"/>-->
                <!--</td>-->
                <!--<td id="sample3">358097051808970</td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td id="name4">IMSI</td>-->
                <!--<td id="field4"><label for="imsi">imsi</label></td>-->
                <!--<td id="input4">-->
                    <!--<input type="text" class="input-medium" id="calling_imsi" name="calling_imsi" placeholder="calling_imsi"/>-->
                    <!--<input type="text" class="input-medium" id="called_imsi"  name="called_imsi"  placeholder="called_imsi"/>-->
                <!--</td>-->
                <!--<td id="sample4">466974101216559</td>-->
            <!--</tr>-->
            <tr>
                <td id="name5">主叫號碼</td>
                <td id="field5"><label for="calling_number">calling_number</label></td>
                <td id="input5"><input type="text" class="input-large" id="calling_number" name="calling_number"/></td>
                <td id="sample5">886920595996</td>
            </tr>

            <!-- <tr>
                 <td id="name6">Last CellID</td>
                 <td id="field6"><label for="calling_subs_last_ci">calling_subs_last_ci</label></td>
                 <td id="input6"><input type="text" class="input-large" id="calling_subs_last_ci" name="calling_subs_last_ci"/></td>
                 <td id="sample6">14833</td>
             </tr>
             <tr>
                 <td id="name7">Last LAC</td>
                 <td id="field7"><label for="calling_subs_last_lac">calling_subs_last_lac</label></td>
                 <td id="input7"><input type="text" class="input-large" id="calling_subs_last_lac" name="calling_subs_last_lac"/></td>
                 <td id="sample7">11111</td>
             </tr>
             <tr>
                 <td id="name8">Last MCC</td> <td id="field8"><label for="calling_subs_last_mcc">calling_subs_last_mcc</label></td>
                 <td id="input8"><input type="text" class="input-large" id="calling_subs_last_mcc" name="calling_subs_last_mcc"/></td>
                 <td id="sample8">466</td>
             </tr>
             <tr>
                 <td id="name9">Last MNC</td>
                 <td id="field9"><label for="calling_subs_last_mnc">calling_subs_last_mnc</label></td>
                 <td id="input9"><input type="text" class="input-large" id="calling_subs_last_mnc" name="calling_subs_last_mnc"/></td>
                 <td id="sample9">97</td>
             </tr>-->
            <!--<tr>-->
                <!--<td id="name10">交換機</td>-->
                <!--<td id="field10"><label for="exchange_id">exchange_id</label></td>-->
                <!--<td id="input10"><input type="text" class="input-large" id="exchange_id" name="exchange_id"/></td>-->
                <!--<td id="sample10">886935420431</td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td id="name11">結束碼</td>-->
                <!--<td id="field11"><label for="cause_for_termination">cause_for_termination</label></td>-->
                <!--<td id="input11"><input type="text" class="input-large" id="cause_for_termination"-->
                                        <!--name="cause_for_termination"/></td>-->
                <!--<td id="sample11">00000000</td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td id="name14">通話時間</td>-->
                <!--<td id="field14"><label for="orig_mcz_duration">orig_mcz_duration</label></td>-->
                <!--<td id="input14">-->
                    <!--<input type="text" class="input-medium" id="orig_mcz_duration" name="orig_mcz_duration" placeholder="orig_mcz_duration"/>-->
                    <!--<input type="text" class="input-medium" id="term_mcz_duration" name="term_mcz_duration" placeholder="term_mcz_duration"/>-->
                <!--</td>-->
                <!--<td id="sample14">11</td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td id="name15">Radio Network Type</td>-->
                <!--<td id="field15"><label for="radio_network_type">radio_network_type</label></td>-->
                <!--<td id="input15"><input type="text" class="input-large" id="radio_network_type" name="radio_network_type"/></td>-->
                <!--<td id="sample15">02</td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td id="name16">Record Type</td>-->
                <!--<td id="field16"><label for="record_type">record_type</label></td>-->
                <!--<td id="input16"><input type="text" class="input-large" id="record_type" name="record_type"/></td>-->
                <!--<td id="sample16">1 1:MOC/2:MTC</td>-->
            <!--</tr>-->

            </tbody>
        </table>

        <div class="form-actions">
            <button id="search_button" type="submit" class="btn btn-primary">search</button>
        </div>
    </fieldset>
</form>

        </div>
    </div>
</div>

<p></p>

<% if (resp) { %>
<h3>搜尋結果</h3></br>
<% if (resp.length == 0) { %>
<h4> 查無資料!</h4>
<% } else /*if (resp.length < 20)*/{%>
<h4> 回傳 : <%= totalcount %>筆資料,  顯示前 <%= resp.length %> 筆</h4>
</br></br></br>
<table class="table table-striped table-hover table-condensed table-header-rotated">
    <caption></caption>
    <thead>
    <tr>

        <th id="000"> <!--class="rotate-45"-->#</th>
        <%
            var keys = [];
            for(var k in resp[0]) keys.push(k);

            for(var k in keys){
        %>
        <th class="rotate-45"><div><span><%= keys[k] %></span></div></th>
        <%}%>
        <!--<th id="000" class="rotate-45">#</th>-->
        <!--<th id="k01" class="rotate-45"><div><span>date_time</span></div></th>-->
        <!--&lt;!&ndash;<th id="k02">_id</th>&ndash;&gt;-->
        <!--<th id="k03" class="rotate-45"><div><span>record_type</span></div></th>-->
        <!--<th id="k04" class="rotate-45"><div><span>charging_start_time</span></div></th>-->
        <!--<th id="k05" class="rotate-45"><div><span>charging_end_time</span></div></th>-->
        <!--<th id="k06" class="rotate-45"><div><span>called_number</span></div></th>-->
        <!--<th id="k07" class="rotate-45"><div><span>calling_imei</span></div></th>-->
        <!--<th id="k08" class="rotate-45"><div><span>calling_imsi</span></div></th>-->
        <!--<th id="k09" class="rotate-45"><div><span>calling_number</span></div></th>-->
        <!--<th id="k10" class="rotate-45"><div><span>exchange_id</span></div></th>-->
        <!--<th id="k11" class="rotate-45"><div><span>cause_for_termination</span></div></th>-->
        <!--<th id="k12" class="rotate-45"><div><span>mcz_duration</span></div></th>-->
    </tr>
    <tr>
        <!--<th id="00">#</th>-->

        <!--<th id="k01">日期時間</th>-->
        <!--&lt;!&ndash;<th id="k02">_id</th>&ndash;&gt;-->
        <!--<th id="k03">收發</th>-->
        <!--<th id="k04">通話開始</th>-->
        <!--<th id="k05">通話結束</th>-->
        <!--<th id="k06">被叫號碼</th>-->
        <!--<th id="k07">IMEI</th>-->
        <!--<th id="k08">IMSI</th>-->
        <!--<th id="k09">打出號碼</th>-->
        <!--<th id="k10">交換機</th>-->
        <!--<th id="k11">結束碼</th>-->
        <!--<th id="k12">通話時間(秒)</th>-->

    </tr>
    </thead>
    <tbody>
    <% var i=1; %>
    <% resp.forEach( function(body){ %>
    <tr>

        <td id="#"><%= i++ %></td>

        <%
            for(var k in keys){
        %>
        <td id="kv"><%= body[''+keys[k]] %></td>

        <%}%>

        <!--<td id="k-v01"  text="日期時間" ><%= (body.date_time          ) %></td>-->
        <!--&lt;!&ndash;<td id="k-v02"  text="日期時間" ><%= (body._id                ) %></td>&ndash;&gt;-->
        <!--<td id="k-v03"  text="日期時間" ><%= (body.record_type        ) %></td>-->
        <!--<td id="k-v04"  text="日期時間" ><%= (body.charging_start_time).substr(-9) %></td>-->
        <!--<td id="k-v05"  text="日期時間" ><%= (body.charging_end_time  ).substr(-9) %></td>-->
        <!--<td id="k-v06"  text="日期時間" ><%= (body.called_number      ) %></td>-->

        <!--<td id="k-v07"  text="日期時間" ><%= (body.calling_imei       ) +'\n'+(body.called_imei       )%></td>-->
        <!--<td id="k-v08"  text="日期時間" ><%= (body.calling_imsi       ) +'\n'+(body.called_imsi       )%></td>-->
        <!--<td id="k-v09"  text="日期時間" ><%= (body.calling_number     ) %></td>-->
        <!--<td id="k-v10"  text="日期時間" ><%= (body.exchange_id        ) %></td>-->
        <!--<td id="k-v11"  text="日期時間" ><%= (body.cause_for_termination) %></td>-->
        <!--<td id="k-v12"  text="日期時間" ><%= (body.orig_mcz_duration  ) +'\n'+(body.term_mcz_duration) %></td>-->
    </tr>
    <% }); %>
    </tbody>
</table>
<% } %>
<% } else { %>
<h3>總量 : <%= totalcount %>筆資料</h3>
<% } %>

</body>
</html>